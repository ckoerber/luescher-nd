import sys
import numpy as np
import os
import matplotlib.pyplot as plt

# here is data for a/L = .1 in x, S(x) pairs

aL_0p1_disp10=np.array([-2.73470341158088, -0.295842318101740, 0.153639540916641, \
-0.295842318101740, 1.47962533343492, -0.29584231810174, \
3.00131431402746, -0.29584231810174, 4.40508283610926, \
-0.2958423181017, 7.12481776080224, -0.29584231810174, \
8.52980526676340, -0.2958423181017, 9.48787239913195, \
-0.2958423181017, 12.1910923480653, -0.2958423181017, \
15.2923606537653, -0.2958423181017, 16.4698647679482, \
-0.2958423181017, 17.7865948784202, -0.295842318102, \
19.4810095464264, -0.2958423181017, 24.0797928013540, \
-0.2958423181017, 25.8261599756687, -0.295842318102, \
28.7172420714557, -0.295842318102])

aL_0p1_disp20=np.array([-2.58008954800629, -0.295842318101740, 0.152890604775840, \
-0.295842318101740, 1.47536819655635, -0.29584231810174, \
2.97767210652014, -0.29584231810174, 4.39672348097504, \
-0.2958423181017, 7.05506388304924, -0.29584231810174, \
8.50681264482012, -0.2958423181017, 9.46832566906794, \
-0.2958423181017, 12.0974380393384, -0.2958423181017, \
15.1370522420590, -0.2958423181017, 16.4255027495286, \
-0.2958423181017, 17.7596231662985, -0.295842318102, \
19.3749499022106, -0.2958423181017, 23.3992212059327, \
-0.2958423181017, 25.6724098322626, -0.295842318102, \
                        28.3709680003576, -0.2958423181017])

aL_0p1_disp40=np.array([-2.54485725106549, -0.295842318101740, 0.152705299669215, \
-0.295842318101740, 1.47434665656660, -0.29584231810174, \
2.97218721210225, -0.29584231810174, 4.39483549055048, \
-0.2958423181017, 7.03962452425900, -0.29584231810174, \
8.50202739805715, -0.2958423181017, 9.46434311054509, \
-0.2958423181017, 12.0784097224933, -0.2958423181017, \
15.1077055503012, -0.2958423181017, 16.4184106439616, \
-0.2958423181017, 17.7551153659750, -0.295842318102, \
19.3580076714785, -0.2958423181017, 23.3299169937119, \
-0.2958423181017, 25.6666533094239, -0.295842318102, \
                        28.3425905778256, -0.2958423181017])

aL_0p1_spher10=np.array([-2.73470341158088, -0.320200201769801, 0.153639540916641, \
-0.290754572959625, 1.47962533343492, -0.27620800371479, \
3.00131431402746, -0.25859334642163, 4.40508283610926, \
-0.2413630047660, 7.12481776080224, -0.20480596715393, \
8.52980526676340, -0.1839549395278, 9.48787239913195, \
-0.1688167438230, 12.1910923480653, -0.1211395748504, \
15.2923606537653, -0.0537893942710, 16.4698647679482, \
-0.0229328645455, 17.7865948784202, 0.016697179834, \
19.4810095464264, 0.0795381734448, 24.0797928013540, \
0.5732853974901, 25.8261599756687, 2.336027902236, \
                         28.7172420714557, 1.496251327058])

aL_0p1_spher20=np.array([-2.58008954800629, -0.301663763457557, 0.152890604775840, \
-0.294579160927475, 1.47536819655635, -0.29109107452057, \
2.97767210652014, -0.28707972327939, 4.39672348097504, \
-0.2832415905968, 7.05506388304924, -0.27591872596845, \
8.50681264482012, -0.2718439460493, 9.46832566906794, \
-0.2691147685933, 12.0974380393384, -0.2615244596214, \
15.1370522420590, -0.2525052433974, 16.4255027495286, \
-0.2485994189862, 17.7596231662985, -0.244501183772, \
19.3749499022106, -0.2394633899389, 23.3992212059327, \
-0.2265330791376, 25.6724098322626, -0.218975044081, \
28.3709680003576, -0.2097474261731])

aL_0p1_spher40=np.array([-2.54485725106549, -0.297284010749952, 0.152705299669215, \
-0.295530217775828, 1.47434665656660, -0.29466729160875, \
2.97218721210225, -0.29368637655602, 4.39483549055048, \
-0.2927517885370, 7.03962452425900, -0.29100672252999, \
8.50202739805715, -0.2900375260651, 9.46434311054509, \
-0.2893980817290, 12.0784097224933, -0.2876543044129, \
15.1077055503012, -0.2856210365921, 16.4184106439616, \
-0.2847370857222, 17.7551153659750, -0.283832962802, \
19.3580076714785, -0.2827452606156, 23.3299169937119, \
-0.2800331860598, 25.6666533094239, -0.278426316823, \
28.3425905778256, -0.2765757559936])


# here is data for a/L = 1/(2pi) in x, S(x) pairs

aL_0p159_disp10 = np.array([-1.03051077388111, 0, 0.234400540786976, \
                            0, 1.56393609916508, 0, 3.23613825863568, \
                            0, 4.46528942387725, 0, 7.36229218910651, \
                            0, 8.60347528421137, 0, 9.54316893745251, \
                            0, 12.3478789922630, 0, 15.4660489194050, \
                            0, 16.5262361217192, 0, 17.8117667843333, \
                            0, 19.5559103666601, 0, 24.2517826779075, \
                            0, 25.8440647842192, 0, 33.7800810584345, \
                            0])

aL_0p159_disp20 = np.array([-1.01312317660914, 0, 0.232793747301060, \
                            0, 1.55963903123836, 0, 3.21389026688313, \
                            0, 4.45666377126124, 0, 7.31190280791624, \
                            0, 8.58235163679642, 0, 9.52488050048255, \
                            0, 12.2794698061858, 0, 15.3563280139602, \
                            0, 16.4835283214625, 0, 17.7898210548452, \
                            0, 19.4744091250509, 0, 23.7208098516597, \
                            0, 25.6992947657877, 0, 28.4752499638712, \
                            0])

aL_0p159_disp40 = np.array([-1.00899038944094, 0, 0.232398179870060, \
                            0, 1.55860429241266, 0, 3.20867103454158, \
                            0, 4.45470363295020, 0, 7.30057483731991, \
                            0, 8.57787430990161, 0, 9.52111188375790, \
                            0, 12.2655072377296, 0, 15.3352037468770, \
                            0, 16.4765014135692, 0, 17.7861553834109, \
                            0, 19.4614436927236, 0, 23.6693142698184, \
                            0, 25.6941238329772, 0, 28.4543399923567, \
                            0])

aL_0p159_spher10 = np.array([-1.03051077388111, -0.007333388375365, 0.234400540786976, \
                             0.005953849207190, 1.56393609916508, 0.02058355059052, \
                             3.23613825863568, 0.04006245211186, 4.46528942387725, \
                             0.0552412249678, 7.36229218910651, 0.0944567447080, \
                             8.60347528421137, 0.1130234413670, 9.54316893745251, \
                             0.1279242871699, 12.3478789922630, 0.1777348204302, \
                             15.4660489194050, 0.2463796200894, 16.5262361217192, \
                             0.2744839289322, 17.8117667843333, 0.313362329236, \
                             19.5559103666601, 0.3785862839134, 24.2517826779075, \
                             0.9491236489550, 25.8440647842192, 2.906203263274, \
                             33.7800810584345, 2.658849489940])

aL_0p159_spher20 = np.array([-1.01312317660914, -0.001779557408732, 0.232793747301060, \
                             0.001472777933145, 1.55963903123836, 0.00497486743144, \
                             3.21389026688313, 0.00939815534993, 4.45666377126124, \
                             0.0127639177774, 7.31190280791624, 0.0206405248687, \
                             8.58235163679642, 0.0242118981141, 9.52488050048255, \
                             0.0268888421474, 12.2794698061858, 0.0348504893361, \
                             15.3563280139602, 0.0439982344346, 16.4835283214625, \
                             0.0474199928003, 17.7898210548452, 0.051434545572, \
                             19.4744091250509, 0.0566918871707, 23.7208098516597, \
                             0.0703669650573, 25.6992947657877, 0.076957814473, \
                             28.4752499638712, 0.0864572706574])

aL_0p159_spher40 = np.array([-1.00899038944094, -0.000444394086356, 0.232398179870060, \
                             0.000364064665887, 1.55860429241266, 0.00123012242687, \
                             3.20867103454158, 0.00231109881237, 4.45470363295020, \
                             0.0031299216181, 7.30057483731991, 0.00500831383485, \
                             8.57787430990161, 0.0058551427403, 9.52111188375790, \
                             0.0064820000993, 12.2655072377296, 0.0083132033044, \
                             15.3352037468770, 0.0103745252609, 16.4765014135692, \
                             0.0111444684494, 17.7861553834109, 0.012030381980, \
                             19.4614436927236, 0.0131673808663, 23.6693142698184, \
                             0.0160419966875, 25.6941238329772, 0.017434941864, \
                             28.4543399923567, 0.0193440874618])

# these are the functions for the corrections

def func10(x):
    return 0.00344692554631769859398767610278709288 + \
        x*0.01065059588826794894762880237234049883 + \
        x*x*0.00018851631952149301981676639887258386

def func20(x):
    return 0.00086245894323278825641918329222810554 + \
        x*0.002619098776312079002169 + \
        x*x*0.000011225311566794286173

def func40(x):
    return 0.00021255228526899379182 + \
        x*0.000651790641624548286120 + \
        x*x*0.000000692647833952229435

#print(aL_0p1_disp10[0::2])
#print(aL_0p1_disp10[1::2])

fig, axs = plt.subplots(1,2,tight_layout=True)
axs[0].plot(aL_0p1_disp10[0::2], aL_0p1_disp10[1::2],'o',color='black',markersize=4)
axs[0].plot(aL_0p1_disp20[0::2], aL_0p1_disp20[1::2],'o',color='black',markersize=4)
axs[0].plot(aL_0p1_disp40[0::2], aL_0p1_disp40[1::2],'o',color='black',markersize=4)

axs[0].plot(aL_0p1_spher10[0::2], aL_0p1_spher10[1::2],'or',markersize=4)
axs[0].plot(aL_0p1_spher20[0::2], aL_0p1_spher20[1::2],'og',markersize=4)
axs[0].plot(aL_0p1_spher40[0::2], aL_0p1_spher40[1::2],'ob',markersize=4)

# not add the analytic lines
x = np.arange(-3, 10, 0.1)
axs[0].plot(x, -0.295842+func10(x),'r--',markersize=4)
axs[0].plot(x, -0.295842+func20(x),'g--',markersize=4)
axs[0].plot(x, -0.295842+func40(x),'b--',markersize=4)

axs[0].plot(x, np.array([-0.295842 for i in range(len(x))]),'--',color='black',markersize=4)

axs[0].set_xlim([-3,10])
axs[0].set_ylim([-.33,-.15])
axs[0].grid(True)

axs[0].set_title(r'$\tilde a_2/L=\frac{1}{10}$')
axs[0].set_xlabel(r'$x$')
axs[0].set_ylabel(r'$\cot\left(\delta_2\right)-\frac{2}{\pi}\log\left(\sqrt{x}\right)$')

# this is the figure set at "unitary point"

axs[1].plot(aL_0p159_disp10[0::2], aL_0p159_disp10[1::2],'o',color='black',markersize=4)
axs[1].plot(aL_0p159_disp20[0::2], aL_0p159_disp20[1::2],'o',color='black',markersize=4)
axs[1].plot(aL_0p159_disp40[0::2], aL_0p159_disp40[1::2],'o',color='black',markersize=4)

axs[1].plot(aL_0p159_spher10[0::2], aL_0p159_spher10[1::2],'or',markersize=4)
axs[1].plot(aL_0p159_spher20[0::2], aL_0p159_spher20[1::2],'og',markersize=4)
axs[1].plot(aL_0p159_spher40[0::2], aL_0p159_spher40[1::2],'ob',markersize=4)

# not add the analytic lines
x = np.arange(-3, 10, 0.1)
axs[1].plot(x, 0+func10(x),'r--',markersize=4)
axs[1].plot(x, 0+func20(x),'g--',markersize=4)
axs[1].plot(x, 0+func40(x),'b--',markersize=4)

axs[1].plot(x, np.array([0 for i in range(len(x))]),'--',color='black',markersize=4)

axs[1].set_xlim([-2,10])
axs[1].set_ylim([-.025,.14])
axs[1].grid(True)

axs[1].set_title(r'$\tilde a_2/L=\frac{1}{2\pi}$')
axs[1].set_xlabel(r'$x$')
axs[1].set_ylabel(r'$\cot\left(\delta_2\right)-\frac{2}{\pi}\log\left(\sqrt{x}\right)$')

plt.show()
