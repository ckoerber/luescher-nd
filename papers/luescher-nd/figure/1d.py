import sys
import numpy as np
import os
import matplotlib.pyplot as plt
import matplotlib.patches as patches
import matplotlib.lines as lines

from luescher_nd.plotting.styles import setup
from luescher_nd.plotting.styles import EXPORT_OPTIONS
from luescher_nd.plotting.styles import LINE_STYLE
from luescher_nd.plotting.styles import MARKERS
from luescher_nd.plotting.styles import finalize

# here is data for a/L = .1 in x, S(x) pairs

aL_0p1_disp10=np.array([-1.76295046178822, 0.1000000000000000, 0.415414454868958, \
                        0.100000000000000, 3.23849005773141, 0.100000000000000, \
                        8.21006785303623, 0.10000000000000, 15.2240379377390, \
                        0.10000000000000])

aL_0p1_disp12=np.array([-1.86214993029807, 0.1000000000000000, 0.409618510430973, \
                        0.100000000000000, 3.21907566155278, 0.100000000000000, \
                        8.18111691460233, 0.10000000000000, 15.1776021606897, \
                        0.10000000000000])

aL_0p1_disp14=np.array([-1.93896529925145, 0.1000000000000000, 0.405532818811776, \
                        0.100000000000000, 3.20532453731646, 0.100000000000000, \
                        8.16177692791202, 0.10000000000000, 15.1515241730984, \
                        0.10000000000000])

aL_0p1_spher10=np.array([-1.76295046178822, 0.1199242302617006, 0.415414454868958, \
                         0.120516168101038, 3.23849005773141, 0.121390517969203, \
                         8.21006785303623, 0.12335117736387, 15.2240379377390, \
                         0.12799654320669])

aL_0p1_spher12=np.array([-1.86214993029807, 0.1166747614372176, 0.409618510430973, \
                         0.117030891894057, 3.21907566155278, 0.117512675617685, \
                         8.18111691460233, 0.11850445004450, 15.1776021606897, \
                         0.12036107941235])

aL_0p1_spher14=np.array([-1.93896529925145, 0.1143333347642198, 0.405532818811776, \
                         0.114564436936616, 3.20532453731646, 0.114859157221249, \
                         8.16177692791202, 0.11543982296492, 15.1515241730984, \
                         0.11642611109557])


# here is data for a/L = 1/(2pi) in x, S(x) pairs (this corresponds to the scale invariant case)

aL_0_disp10 = np.array([0.271770474806045, 0, 2.44993041303395, \
                        0, 6.83176863903872, 0, 13.5044695050820, 0])

aL_0_disp12 = np.array([0.267897554078373, 0, 2.41322805680711, \
                        0, 6.71672301596348, 0, 13.2131583951192, \
                        0])

aL_0_disp14 = np.array([0.265199188175036, 0, 2.38808479708920, \
                        0, 6.64130452091945, 0, 13.0430752990772, 0])

aL_0_spher10 = np.array([0.271770474806045, 0.020475120713068, 2.44993041303395, \
                         0.021132376482532, 6.83176863903872, 0.022739275829953, \
                         13.5044695050820, 0.026510571297508])

aL_0_spher12 = np.array([0.267897554078373, 0.017007855052631, 2.41322805680711, \
                         0.017369360764884, 6.71672301596348, 0.018190037501478, \
                         13.2131583951192, 0.019767779575484])

aL_0_spher14 = np.array([0.265199188175036, 0.014550219589812, 2.38808479708920, \
                         0.014770877947940, 6.64130452091945, 0.015252816834117, \
                         13.0430752990772, 0.016103798633094])

# and here is spherical luescher S1/(2pi^2) in (x, S1(x)/(2pi^2)) pairs

s1 = np.array([-3.5, 0.0850732, -3.49, 0.085195, -3.48, 0.0853174, -3.47, 0.0854403, -3.46, 0.0855637, -3.45, 0.0856876, -3.44, 0.0858121, -3.43, 0.0859371, -3.42, 0.0860627, -3.41, 0.0861888, -3.4, 0.0863155, -3.39, 0.0864427, -3.38, \
               0.0865705, -3.37, 0.0866989, -3.36, 0.0868279, -3.35, 0.0869574, -3.34, 0.0870875, -3.33, 0.0872182, -3.32, 0.0873495, -3.31, 0.0874814, -3.3, 0.0876138, -3.29, 0.0877469, -3.28, 0.0878806, -3.27, 0.0880149, -3.26, \
               0.0881499, -3.25, 0.0882854, -3.24, 0.0884216, -3.23, 0.0885584, -3.22, 0.0886958, -3.21, 0.0888339, -3.2, 0.0889727, -3.19, 0.089112, -3.18, 0.0892521, -3.17, 0.0893928, -3.16, 0.0895342, -3.15, 0.0896762, -3.14, \
               0.089819, -3.13, 0.0899624, -3.12, 0.0901065, -3.11, 0.0902513, -3.1, 0.0903968, -3.09, 0.090543, -3.08, 0.0906899, -3.07, 0.0908375, -3.06, 0.0909859, -3.05, 0.091135, -3.04, 0.0912848, -3.03, 0.0914354, -3.02, 0.0915867, -3.01, \
               0.0917388, -3., 0.0918916, -2.99, 0.0920452, -2.98, 0.0921996, -2.97, 0.0923547, -2.96, 0.0925107, -2.95, 0.0926674, -2.94, 0.0928249, -2.93, 0.0929833, -2.92, 0.0931424, -2.91, 0.0933024, -2.9, 0.0934632, -2.89, 0.0936249, -2.88, \
               0.0937873, -2.87, 0.0939507, -2.86, 0.0941149, -2.85, 0.0942799, -2.84, 0.0944458, -2.83, 0.0946127, -2.82, 0.0947803, -2.81, 0.0949489, -2.8, 0.0951184, -2.79, 0.0952888, -2.78, 0.0954602, -2.77, 0.0956324, -2.76, \
               0.0958056, -2.75, 0.0959798, -2.74, 0.0961549, -2.73, 0.0963309, -2.72, 0.096508, -2.71, 0.096686, -2.7, 0.096865, -2.69, 0.097045, -2.68, 0.097226, -2.67, 0.097408, -2.66, 0.0975911, -2.65, 0.0977752, -2.64, 0.0979603, -2.63, \
               0.0981465, -2.62, 0.0983338, -2.61, 0.0985221, -2.6, 0.0987116, -2.59, 0.0989021, -2.58, 0.0990937, -2.57, 0.0992865, -2.56, 0.0994804, -2.55, 0.0996754, -2.54, 0.0998716, -2.53, 0.100069, -2.52, 0.100268, -2.51, 0.100467, \
               -2.5, 0.100668, -2.49, 0.10087, -2.48, 0.101074, -2.47, 0.101278, -2.46, 0.101484, -2.45, 0.101691, -2.44, 0.1019, -2.43, 0.102109, -2.42, 0.10232, -2.41, 0.102533, -2.4, 0.102746, -2.39, 0.102961, -2.38, 0.103178, -2.37, 0.103395, \
               -2.36, 0.103614, -2.35, 0.103835, -2.34, 0.104057, -2.33, 0.10428, -2.32, 0.104505, -2.31, 0.104731, -2.3, 0.104959, -2.29, 0.105188, -2.28, 0.105419, -2.27, 0.105651, -2.26, 0.105885, -2.25, 0.10612, -2.24, 0.106357, -2.23, 0.106596, \
               -2.22, 0.106836, -2.21, 0.107078, -2.2, 0.107321, -2.19, 0.107567, -2.18, 0.107813, -2.17, 0.108062, -2.16, 0.108312, -2.15, 0.108564, -2.14, 0.108818, -2.13, 0.109074, -2.12, 0.109331, -2.11, 0.109591, -2.1, 0.109852, -2.09, 0.110115, \
               -2.08, 0.11038, -2.07, 0.110647, -2.06, 0.110915, -2.05, 0.111186, -2.04, 0.111459, -2.03, 0.111734, -2.02, 0.112011, -2.01, 0.11229, -2., 0.112571, -1.99, 0.112854, -1.98, 0.113139, -1.97, 0.113427, -1.96, 0.113717, -1.95, 0.114008, \
               -1.94, 0.114303, -1.93, 0.114599, -1.92, 0.114898, -1.91, 0.115199, -1.9, 0.115503, -1.89, 0.115809, -1.88, 0.116118, -1.87, 0.116429, -1.86, 0.116742, -1.85, 0.117059, -1.84, 0.117377, -1.83, 0.117699, -1.82, 0.118023, -1.81, 0.118349, \
               -1.8, 0.118679, -1.79, 0.119011, -1.78, 0.119346, -1.77, 0.119684, -1.76, 0.120025, -1.75, 0.120369, -1.74, 0.120716, -1.73, 0.121066, -1.72, 0.121419, -1.71, 0.121775, -1.7, 0.122134, -1.69, 0.122496, -1.68, 0.122862, -1.67, 0.123231, \
               -1.66, 0.123604, -1.65, 0.123979, -1.64, 0.124359, -1.63, 0.124742, -1.62, 0.125128, -1.61, 0.125518, -1.6, 0.125912, -1.59, 0.12631, -1.58, 0.126711, -1.57, 0.127116, -1.56, 0.127526, -1.55, 0.127939, -1.54, 0.128356, -1.53, 0.128778, \
               -1.52, 0.129203, -1.51, 0.129633, -1.5, 0.130068, -1.49, 0.130507, -1.48, 0.13095, -1.47, 0.131398, -1.46, 0.131851, -1.45, 0.132308, -1.44, 0.13277, -1.43, 0.133237, -1.42, 0.13371, -1.41, 0.134187, -1.4, 0.134669, -1.39, 0.135157, \
               -1.38, 0.135651, -1.37, 0.136149, -1.36, 0.136654, -1.35, 0.137164, -1.34, 0.13768, -1.33, 0.138202, -1.32, 0.13873, -1.31, 0.139264, -1.3, 0.139804, -1.29, 0.140351, -1.28, 0.140905, -1.27, 0.141465, -1.26, 0.142032, -1.25, 0.142606, \
               -1.24, 0.143187, -1.23, 0.143776, -1.22, 0.144371, -1.21, 0.144975, -1.2, 0.145586, -1.19, 0.146205, -1.18, 0.146833, -1.17, 0.147468, -1.16, 0.148112, -1.15, 0.148765, -1.14, 0.149427, -1.13, 0.150097, -1.12, 0.150777, -1.11, 0.151467, \
               -1.1, 0.152166, -1.09, 0.152875, -1.08, 0.153595, -1.07, 0.154325, -1.06, 0.155065, -1.05, 0.155817, -1.04, 0.15658, -1.03, 0.157354, -1.02, 0.158141, -1.01, 0.158939, -1., 0.15975, -0.99, 0.160574, -0.98, 0.161412, -0.97, 0.162262, \
               -0.96, 0.163127, -0.95, 0.164006, -0.94, 0.1649, -0.93, 0.165809, -0.92, 0.166733, -0.91, 0.167674, -0.9, 0.168631, -0.89, 0.169606, -0.88, 0.170597, -0.87, 0.171607, -0.86, 0.172636, -0.85, 0.173684, -0.84, 0.174752, -0.83, 0.17584, \
               -0.82, 0.17695, -0.81, 0.178081, -0.8, 0.179235, -0.79, 0.180413, -0.78, 0.181615, -0.77, 0.182842, -0.76, 0.184096, -0.75, 0.185376, -0.74, 0.186684, -0.73, 0.188022, -0.72, 0.189389, -0.71, 0.190788, -0.7, 0.19222, -0.69, 0.193685, \
               -0.68, 0.195186, -0.67, 0.196723, -0.66, 0.198299, -0.65, 0.199914, -0.64, 0.201572, -0.63, 0.203272, -0.62, 0.205019, -0.61, 0.206812, -0.6, 0.208656, -0.59, 0.210551, -0.58, 0.212501, -0.57, 0.214509, -0.56, 0.216577, -0.55, 0.218708, \
               -0.54, 0.220905, -0.53, 0.223173, -0.52, 0.225515, -0.51, 0.227934, -0.5, 0.230437, -0.49, 0.233027, -0.48, 0.235709, -0.47, 0.238489, -0.46, 0.241374, -0.45, 0.24437, -0.44, 0.247483, -0.43, 0.250723, -0.42, 0.254098, -0.41, 0.257617, \
               -0.4, 0.26129, -0.39, 0.265129, -0.38, 0.269147, -0.37, 0.273358, -0.36, 0.277777, -0.35, 0.282422, -0.34, 0.287312, -0.33, 0.292469, -0.32, 0.297917, -0.31, 0.303683, -0.3, 0.309799, -0.29, 0.3163, -0.28, 0.323227, -0.27, 0.330626, \
               -0.26, 0.338551, -0.25, 0.347063, -0.24, 0.356236, -0.23, 0.366154, -0.22, 0.376917, -0.21, 0.388645, -0.2, 0.401482, -0.19, 0.4156, -0.18, 0.431212, -0.17, 0.448579, -0.16, 0.468029, -0.15, 0.489975, -0.14, 0.514951, -0.13, 0.543652, \
               -0.12, 0.577006, -0.11, 0.61628, -0.1, 0.663245, -0.09, 0.720459, -0.08, 0.791763, -0.07, 0.883186, -0.06, 1.00478, -0.05, 1.17464, -0.04, 1.42895, -0.03, 1.85215, -0.02, 2.69754, -0.01, 5.23164, 0, np.nan, 0.01, -4.89829, \
               0.02, -2.36413, 0.03, -1.51863, 0.04, -1.09529, 0.05, -0.840791, 0.06, -0.670702, 0.07, -0.548837, 0.08, -0.457101, 0.09, -0.385443, 0.1, -0.327829, 0.11, -0.280422, 0.12, -0.240661, 0.13, -0.206775, 0.14, -0.177497, 0.15, -0.151898, \
               0.16, -0.129281, 0.17, -0.109113, 0.18, -0.090979, 0.19, -0.0745501, 0.2, -0.059564, 0.21, -0.0458076, 0.22, -0.0331062, 0.23, -0.0213153, 0.24, -0.0103138, 0.25, 0, 0.26, 0.0097128, 0.27, 0.0188987, 0.28, 0.0276217, 0.29, \
               0.0359372, 0.3, 0.0438939, 0.31, 0.0515344, 0.32, 0.0588966, 0.33, 0.0660143, 0.34, 0.0729175, 0.35, 0.0796337, 0.36, 0.0861876, 0.37, 0.092602, 0.38, 0.0988977, 0.39, 0.105094, 0.4, 0.11121, 0.41, 0.117261, 0.42, 0.123264, 0.43, 0.129235, \
               0.44, 0.135188, 0.45, 0.141138, 0.46, 0.1471, 0.47, 0.153086, 0.48, 0.159111, 0.49, 0.16519, 0.5, 0.171335, 0.51, 0.177563, 0.52, 0.183886, 0.53, 0.190321, 0.54, 0.196885, 0.55, 0.203592, 0.56, 0.210462, 0.57, 0.217512, 0.58, 0.224763, \
               0.59, 0.232237, 0.6, 0.239956, 0.61, 0.247945, 0.62, 0.256233, 0.63, 0.264847, 0.64, 0.273822, 0.65, 0.283194, 0.66, 0.293003, 0.67, 0.303292, 0.68, 0.314114, 0.69, 0.325522, 0.7, 0.337581, 0.71, 0.350363, 0.72, 0.363949, \
               0.73, 0.378432, 0.74, 0.393921, 0.75, 0.41054, 0.76, 0.428435, 0.77, 0.447776, 0.78, 0.468764, 0.79, 0.491639, 0.8, 0.516686, 0.81, 0.544254, 0.82, 0.574766, 0.83, 0.608746, 0.84, 0.646847, 0.85, 0.689899, 0.86, 0.738966, \
               0.87, 0.795441, 0.88, 0.86118, 0.89, 0.938713, 0.9, 1.03158, 0.91, 1.14491, 0.92, 1.28637, 0.93, 1.46802, 0.94, 1.70998, 0.95, 2.04841, 0.96, 2.55571, 0.97, 3.40073, 0.98, 5.09008, 0.99, 10.1568, 1.,np.nan, 1.01, -10.1061, 1.02, -5.03946, 1.03, -3.35015, \
               1.04, -2.5052, 1.05, -1.99799, 1.06, -1.65965, 1.07, -1.41782, 1.08, -1.23631, 1.09, -1.09501, 1.1, -0.981867, 1.11, -0.889197, 1.12, -0.811884, 1.13, -0.746387, 1.14, -0.690175, 1.15, -0.641391, 1.16, -0.598644, 1.17, -0.560869, \
               1.18, -0.527239, 1.19, -0.497099, 1.2, -0.469927, 1.21, -0.445299, 1.22, -0.422869, 1.23, -0.40235, 1.24, -0.383505, 1.25, -0.366132, 1.26, -0.350063, 1.27, -0.335152, 1.28, -0.321276, 1.29, -0.308328, 1.3, -0.296216, 1.31, -0.284859, \
               1.32, -0.274185, 1.33, -0.264135, 1.34, -0.254651, 1.35, -0.245687, 1.36, -0.237199, 1.37, -0.229149, 1.38, -0.221501, 1.39, -0.214226, 1.4, -0.207295, 1.41, -0.200684, 1.42, -0.194369, 1.43, -0.18833, 1.44, -0.182548, 1.45, -0.177007, \
               1.46, -0.17169, 1.47, -0.166583, 1.48, -0.161673, 1.49, -0.156949, 1.5, -0.152398, 1.51, -0.148012, 1.52, -0.14378, 1.53, -0.139693, 1.54, -0.135744, 1.55, -0.131925, 1.56, -0.128229, 1.57, -0.12465, 1.58, -0.121182, 1.59, -0.117818, \
               1.6, -0.114554, 1.61, -0.111385, 1.62, -0.108307, 1.63, -0.105314, 1.64, -0.102402, 1.65, -0.0995692, 1.66, -0.0968105, 1.67, -0.0941229, 1.68, -0.0915032, 1.69, -0.0889483, 1.7, -0.0864556, 1.71, -0.0840223, 1.72, \
               -0.0816459, 1.73, -0.079324, 1.74, -0.0770544, 1.75, -0.074835, 1.76, -0.0726636, 1.77, -0.0705383, 1.78, -0.0684574, 1.79, -0.0664191, 1.8, -0.0644217, 1.81, -0.0624637, 1.82, -0.0605436, 1.83, -0.0586598, 1.84, \
               -0.0568111, 1.85, -0.0549961, 1.86, -0.0532137, 1.87, -0.0514625, 1.88, -0.0497415, 1.89, -0.0480496, 1.9, -0.0463857, 1.91, -0.0447489, 1.92, -0.0431381, 1.93, -0.0415524, 1.94, -0.039991, 1.95, -0.038453, 1.96, \
               -0.0369376, 1.97, -0.0354439, 1.98, -0.0339713, 1.99, -0.0325191, 2., -0.0310864, 2.01, -0.0296727, 2.02, -0.0282772, 2.03, -0.0268994, 2.04, -0.0255386, 2.05, -0.0241943, 2.06, -0.0228658, 2.07, -0.0215527, 2.08, \
               -0.0202544, 2.09, -0.0189703, 2.1, -0.0177001, 2.11, -0.0164431, 2.12, -0.0151989, 2.13, -0.0139672, 2.14, -0.0127473, 2.15, -0.0115389, 2.16, -0.0103416, 2.17, -0.00915499, 2.18, -0.00797862, 2.19, -0.00681212, 2.2, \
               -0.00565512, 2.21, -0.00450726, 2.22, -0.00336816, 2.23, -0.00223748, 2.24, -0.00111487, 2.25, 0, 2.26, 0.00110746, 2.27, 0.00220784, 2.28, 0.00330145, 2.29, 0.00438859, 2.3, 0.00546959, 2.31, 0.00654473, 2.32, 0.00761431, 2.33, \
               0.00867862, 2.34, 0.00973795, 2.35, 0.0107926, 2.36, 0.0118428, 2.37, 0.0128888, 2.38, 0.013931, 2.39, 0.0149695, 2.4, 0.0160047, 2.41, 0.0170368, 2.42, 0.0180661, 2.43, 0.0190928, 2.44, 0.0201172, 2.45, 0.0211395, 2.46, 0.02216, \
               2.47, 0.0231789, 2.48, 0.0241966, 2.49, 0.0252132, 2.5, 0.0262289, 2.51, 0.0272441, 2.52, 0.028259, 2.53, 0.0292738, 2.54, 0.0302888, 2.55, 0.0313042, 2.56, 0.0323204, 2.57, 0.0333374, 2.58, 0.0343556, 2.59, 0.0353753, 2.6, 0.0363967, \
               2.61, 0.03742, 2.62, 0.0384455, 2.63, 0.0394735, 2.64, 0.0405042, 2.65, 0.0415379, 2.66, 0.0425749, 2.67, 0.0436154, 2.68, 0.0446598, 2.69, 0.0457083, 2.7, 0.0467611, 2.71, 0.0478186, 2.72, 0.0488811, 2.73, 0.0499489, 2.74, 0.0510222, \
               2.75, 0.0521015, 2.76, 0.0531869, 2.77, 0.0542789, 2.78, 0.0553777, 2.79, 0.0564837, 2.8, 0.0575972, 2.81, 0.0587186, 2.82, 0.0598483, 2.83, 0.0609866, 2.84, 0.0621339, 2.85, 0.0632906, 2.86, 0.0644571, 2.87, 0.0656337, 2.88, 0.066821, \
               2.89, 0.0680193, 2.9, 0.0692291, 2.91, 0.0704509, 2.92, 0.0716851, 2.93, 0.0729323, 2.94, 0.0741928, 2.95, 0.0754673, 2.96, 0.0767563, 2.97, 0.0780603, 2.98, 0.07938, 2.99, 0.0807158, 3., 0.0820685, 3.01, 0.0834386, 3.02, 0.0848269, \
               3.03, 0.086234, 3.04, 0.0876606, 3.05, 0.0891074, 3.06, 0.0905753, 3.07, 0.0920651, 3.08, 0.0935775, 3.09, 0.0951134, 3.1, 0.0966738, 3.11, 0.0982596, 3.12, 0.0998717, 3.13, 0.101511, 3.14, 0.103179, 3.15, 0.104877, 3.16, 0.106605, \
               3.17, 0.108365, 3.18, 0.110159, 3.19, 0.111987, 3.2, 0.113851, 3.21, 0.115753, 3.22, 0.117694, 3.23, 0.119675, 3.24, 0.121699, 3.25, 0.123767, 3.26, 0.125881, 3.27, 0.128043, 3.28, 0.130255, 3.29, 0.13252, 3.3, 0.13484, 3.31, \
               0.137216, 3.32, 0.139653, 3.33, 0.142152, 3.34, 0.144717, 3.35, 0.147351, 3.36, 0.150057, 3.37, 0.152839, 3.38, 0.1557, 3.39, 0.158644, 3.4, 0.161676, 3.41, 0.1648, 3.42, 0.168022, 3.43, 0.171345, 3.44, 0.174777, 3.45, 0.178323, 3.46, \
               0.181989, 3.47, 0.185782, 3.48, 0.18971, 3.49, 0.19378, 3.5, 0.198002, 3.51, 0.202385, 3.52, 0.206939, 3.53, 0.211674, 3.54, 0.216604, 3.55, 0.221741, 3.56, 0.227098, 3.57, 0.232693, 3.58, 0.238541, 3.59, 0.244662, 3.6, 0.251075, \
               3.61, 0.257804, 3.62, 0.264874, 3.63, 0.272312, 3.64, 0.28015, 3.65, 0.288421, 3.66, 0.297163, 3.67, 0.306421, 3.68, 0.316242, 3.69, 0.326681, 3.7, 0.337799, 3.71, 0.349668, 3.72, 0.362368, 3.73, 0.375991, 3.74, 0.390644, \
               3.75, 0.40645, 3.76, 0.423554, 3.77, 0.442126, 3.78, 0.462366, 3.79, 0.484512, 3.8, 0.508849, 3.81, 0.535725, 3.82, 0.565563, 3.83, 0.598886, 3.84, 0.636346, 3.85, 0.678772, 3.86, 0.727229, 3.87, 0.783107, 3.88, 0.848263, \
               3.89, 0.925227, 3.9, 1.01754, 3.91, 1.13032, 3.92, 1.27125, 3.93, 1.45238, 3.94, 1.69383, 3.95, 2.03176, 3.96, 2.53857, 3.97, 3.38311, 3.98, 5.072, 3.99, 10.1383, 4.,
               np.nan, 4.01, -10.1256, 4.02, -5.05934, 4.03, -3.37045, 4.04, -2.52592, 4.05, -2.01912, 4.06, -1.68119, 4.07, \
               -1.43976, 4.08, -1.25863, 4.09, -1.11772, 4.1, -1.00495, 4.11, -0.91265, 4.12, -0.835703, 4.13, -0.770566, 4.14, -0.714707, 4.15, -0.666272, 4.16, -0.623869, 4.17, -0.586433, 4.18, -0.553136, 4.19, -0.523326, 4.2, -0.496478, 4.21, \
               -0.472171, 4.22, -0.450057, 4.23, -0.429851, 4.24, -0.411314, 4.25, -0.394246, 4.26, -0.378477, 4.27, -0.363864, 4.28, -0.350282, 4.29, -0.337625, 4.3, -0.3258, 4.31, -0.314727, 4.32, -0.304335, 4.33, -0.294563, 4.34, -0.285356, 4.35, \
               -0.276665, 4.36, -0.268448, 4.37, -0.260666, 4.38, -0.253284, 4.39, -0.246273, 4.4, -0.239604, 4.41, -0.233252, 4.42, -0.227194, 4.43, -0.221411, 4.44, -0.215883, 4.45, -0.210594, 4.46, -0.205527, 4.47, -0.200669, 4.48, -0.196007, 4.49, \
               -0.191528, 4.5, -0.187222, 4.51, -0.183079, 4.52, -0.179089, 4.53, -0.175243, 4.54, -0.171533, 4.55, -0.167953, 4.56, -0.164495, 4.57, -0.161153, 4.58, -0.15792, 4.59, -0.154792, 4.6, -0.151762, 4.61, -0.148827, 4.62, -0.145981, 4.63, \
               -0.143221, 4.64, -0.140542, 4.65, -0.13794, 4.66, -0.135413, 4.67, -0.132956, 4.68, -0.130567, 4.69, -0.128243, 4.7, -0.12598, 4.71, -0.123777, 4.72, -0.121631, 4.73, -0.119539, 4.74, -0.1175, 4.75, -0.115511, 4.76, -0.11357, 4.77, \
               -0.111675, 4.78, -0.109825, 4.79, -0.108018, 4.8, -0.106252, 4.81, -0.104526, 4.82, -0.102838, 4.83, -0.101187, 4.84, -0.0995718, 4.85, -0.0979909, 4.86, -0.0964431, 4.87, -0.0949272, 4.88, -0.0934423, 4.89, -0.0919873, 4.9, \
               -0.0905611, 4.91, -0.0891629, 4.92, -0.0877917, 4.93, -0.0864465, 4.94, -0.0851267, 4.95, -0.0838314, 4.96, -0.0825598, 4.97, -0.0813112, 4.98, -0.0800849, 4.99, -0.0788802, 5., -0.0776964, 5.01, -0.076533, 5.02, -0.0753892, \
               5.03, -0.0742647, 5.04, -0.0731587, 5.05, -0.0720708, 5.06, -0.0710004, 5.07, -0.0699471, 5.08, -0.0689104, 5.09, -0.0678897, 5.1, -0.0668847, 5.11, -0.065895, 5.12, -0.0649201, 5.13, -0.0639596, 5.14, -0.0630131, 5.15, \
               -0.0620803, 5.16, -0.0611608, 5.17, -0.0602543, 5.18, -0.0593604, 5.19, -0.0584788, 5.2, -0.0576092, 5.21, -0.0567513, 5.22, -0.0559047, 5.23, -0.0550693, 5.24, -0.0542447, 5.25, -0.0534307, 5.26, -0.052627, 5.27, \
               -0.0518333, 5.28, -0.0510494, 5.29, -0.0502751, 5.3, -0.0495102, 5.31, -0.0487544, 5.32, -0.0480075, 5.33, -0.0472693, 5.34, -0.0465396, 5.35, -0.0458182, 5.36, -0.0451049, 5.37, -0.0443996, 5.38, -0.043702, 5.39, \
               -0.0430119, 5.4, -0.0423293, 5.41, -0.0416539, 5.42, -0.0409856, 5.43, -0.0403241, 5.44, -0.0396695, 5.45, -0.0390214, 5.46, -0.0383798, 5.47, -0.0377446, 5.48, -0.0371155, 5.49, -0.0364925, 5.5, -0.0358754, 5.51, \
               -0.035264, 5.52, -0.0346584, 5.53, -0.0340583, 5.54, -0.0334637, 5.55, -0.0328743, 5.56, -0.0322902, 5.57, -0.0317111, 5.58, -0.031137, 5.59, -0.0305678, 5.6, -0.0300034, 5.61, -0.0294437, 5.62, -0.0288885, 5.63, \
               -0.0283378, 5.64, -0.0277915, 5.65, -0.0272495, 5.66, -0.0267117, 5.67, -0.0261781, 5.68, -0.0256484, 5.69, -0.0251228, 5.7, -0.0246009, 5.71, -0.0240829, 5.72, -0.0235686, 5.73, -0.0230579, 5.74, -0.0225508, 5.75, \
               -0.0220471, 5.76, -0.0215469, 5.77, -0.02105, 5.78, -0.0205564, 5.79, -0.020066, 5.8, -0.0195787, 5.81, -0.0190944, 5.82, -0.0186132, 5.83, -0.018135, 5.84, -0.0176596, 5.85, -0.017187, 5.86, -0.0167171, 5.87, -0.01625, \
               5.88, -0.0157855, 5.89, -0.0153236, 5.9, -0.0148642, 5.91, -0.0144073, 5.92, -0.0139529, 5.93, -0.0135007, 5.94, -0.0130509, 5.95, -0.0126034, 5.96, -0.012158, 5.97, -0.0117149, 5.98, -0.0112738, 5.99, -0.0108348, 6., \
               -0.0103978, 6.01, -0.00996276, 6.02, -0.00952965, 6.03, -0.00909842, 6.04, -0.00866902, 6.05, -0.0082414, 6.06, -0.00781553, 6.07, -0.00739135, 6.08, -0.00696883, 6.09, -0.00654792, 6.1, -0.00612858, 6.11, -0.00571078, 6.12, \
               -0.00529446, 6.13, -0.00487958, 6.14, -0.00446612, 6.15, -0.00405403, 6.16, -0.00364326, 6.17, -0.00323379, 6.18, -0.00282557, 6.19, -0.00241857, 6.2, -0.00201275, 6.21, -0.00160806, 6.22, -0.00120448, 6.23, -0.000801967, 6.24, \
               -0.000400486, 6.25, 0, 6.26, 0.000399526, 6.27, 0.000798127, 6.28, 0.00119584, 6.29, 0.0015927, 6.3, 0.00198873, 6.31, 0.00238398, 6.32, 0.00277848, 6.33, 0.00317226, 6.34, 0.00356535, 6.35, 0.0039578, 6.36, 0.00434963, 6.37, \
               0.00474087, 6.38, 0.00513156, 6.39, 0.00552173, 6.4, 0.00591142, 6.41, 0.00630066, 6.42, 0.00668947, 6.43, 0.0070779, 6.44, 0.00746597, 6.45, 0.00785371, 6.46, 0.00824117, 6.47, 0.00862837, 6.48, 0.00901534, 6.49, \
               0.00940211, 6.5, 0.00978873, 6.51, 0.0101752, 6.52, 0.0105616, 6.53, 0.0109479, 6.54, 0.0113342, 6.55, 0.0117205, 6.56, 0.0121068, 6.57, 0.0124932, 6.58, 0.0128796, 6.59, 0.0132662, 6.6, 0.013653, 6.61, 0.0140399, 6.62, 0.0144271, 6.63, \
               0.0148145, 6.64, 0.0152022, 6.65, 0.0155903, 6.66, 0.0159786, 6.67, 0.0163674, 6.68, 0.0167566, 6.69, 0.0171463, 6.7, 0.0175364, 6.71, 0.0179271, 6.72, 0.0183183, 6.73, 0.0187101, 6.74, 0.0191026, 6.75, 0.0194957, 6.76, 0.0198895, 6.77, \
               0.020284, 6.78, 0.0206793, 6.79, 0.0210754, 6.8, 0.0214723, 6.81, 0.0218701, 6.82, 0.0222688, 6.83, 0.0226685, 6.84, 0.0230691, 6.85, 0.0234708, 6.86, 0.0238736, 6.87, 0.0242774, 6.88, 0.0246824, 6.89, 0.0250885, 6.9, 0.0254959, 6.91, \
               0.0259045, 6.92, 0.0263145, 6.93, 0.0267258, 6.94, 0.0271384, 6.95, 0.0275525, 6.96, 0.0279681, 6.97, 0.0283851, 6.98, 0.0288038, 6.99, 0.029224, 7., 0.0296459, 7.01, 0.0300694, 7.02, 0.0304947, 7.03, 0.0309218, 7.04, 0.0313507, 7.05, \
               0.0317815, 7.06, 0.0322143, 7.07, 0.032649, 7.08, 0.0330857, 7.09, 0.0335246, 7.1, 0.0339655, 7.11, 0.0344087, 7.12, 0.0348541, 7.13, 0.0353018, 7.14, 0.0357518, 7.15, 0.0362043, 7.16, 0.0366593, 7.17, 0.0371167, 7.18, 0.0375768, 7.19, \
               0.0380395, 7.2, 0.038505, 7.21, 0.0389732, 7.22, 0.0394442, 7.23, 0.0399182, 7.24, 0.0403951, 7.25, 0.0408751, 7.26, 0.0413582, 7.27, 0.0418445, 7.28, 0.0423341, 7.29, 0.042827, 7.3, 0.0433233, 7.31, 0.0438231, 7.32, 0.0443264, 7.33, \
               0.0448334, 7.34, 0.0453442, 7.35, 0.0458588, 7.36, 0.0463772, 7.37, 0.0468997, 7.38, 0.0474262, 7.39, 0.0479569, 7.4, 0.0484919, 7.41, 0.0490313, 7.42, 0.0495751, 7.43, 0.0501235, 7.44, 0.0506765, 7.45, 0.0512344, 7.46, 0.0517971, 7.47, \
               0.0523648, 7.48, 0.0529376, 7.49, 0.0535157, 7.5, 0.0540991, 7.51, 0.054688, 7.52, 0.0552825, 7.53, 0.0558827, 7.54, 0.0564887, 7.55, 0.0571008, 7.56, 0.057719, 7.57, 0.0583435, 7.58, 0.0589744, 7.59, 0.0596119, 7.6, 0.0602561, 7.61, \
               0.0609072, 7.62, 0.0615654, 7.63, 0.0622308, 7.64, 0.0629037, 7.65, 0.0635841, 7.66, 0.0642723, 7.67, 0.0649684, 7.68, 0.0656727, 7.69, 0.0663853, 7.7, 0.0671065, 7.71, 0.0678365, 7.72, 0.0685755, 7.73, 0.0693237, 7.74, 0.0700813, 7.75, \
               0.0708487, 7.76, 0.071626, 7.77, 0.0724135, 7.78, 0.0732114, 7.79, 0.0740201, 7.8, 0.0748399, 7.81, 0.0756709, 7.82, 0.0765136, 7.83, 0.0773682, 7.84, 0.078235, 7.85, 0.0791144, 7.86, 0.0800068, 7.87, 0.0809124, 7.88, 0.0818317, 7.89, \
               0.082765, 7.9, 0.0837128, 7.91, 0.0846754, 7.92, 0.0856533, 7.93, 0.0866469, 7.94, 0.0876566, 7.95, 0.0886831, 7.96, 0.0897266, 7.97, 0.0907878, 7.98, 0.0918672, 7.99, 0.0929654, 8., 0.0940828, 8.01, 0.0952202, 8.02, 0.0963781, 8.03, \
               0.0975572, 8.04, 0.0987582, 8.05, 0.0999817, 8.06, 0.101229, 8.07, 0.102499, 8.08, 0.103795, 8.09, 0.105117, 8.1, 0.106465, 8.11, 0.10784, 8.12, 0.109244, 8.13, 0.110678, 8.14, 0.112141, 8.15, 0.113637, 8.16, 0.115165, 8.17, \
               0.116727, 8.18, 0.118324, 8.19, 0.119957, 8.2, 0.121629, 8.21, 0.123339, 8.22, 0.125091, 8.23, 0.126885, 8.24, 0.128723, 8.25, 0.130607, 8.26, 0.132538, 8.27, 0.13452, 8.28, 0.136553, 8.29, 0.13864, 8.3, 0.140784, 8.31, 0.142986, \
               8.32, 0.14525, 8.33, 0.147578, 8.34, 0.149973, 8.35, 0.152438, 8.36, 0.154977, 8.37, 0.157593, 8.38, 0.16029, 8.39, 0.163072, 8.4, 0.165942, 8.41, 0.168906, 8.42, 0.171969, 8.43, 0.175135, 8.44, 0.178411, 8.45, 0.181801, \
               8.46, 0.185314, 8.47, 0.188955, 8.48, 0.192731, 8.49, 0.196652, 8.5, 0.200725, 8.51, 0.20496, 8.52, 0.209367, 8.53, 0.213958, 8.54, 0.218743, 8.55, 0.223737, 8.56, 0.228952, 8.57, 0.234406, 8.58, 0.240114, 8.59, 0.246096, 8.6, \
               0.252371, 8.61, 0.258964, 8.62, 0.265898, 8.63, 0.273201, 8.64, 0.280904, 8.65, 0.289042, 8.66, 0.297653, 8.67, 0.30678, 8.68, 0.31647, 8.69, 0.32678, 8.7, 0.33777, 8.71, 0.349512, 8.72, 0.362085, 8.73, 0.375582, 8.74, 0.39011, \
               8.75, 0.405792, 8.76, 0.422774, 8.77, 0.441223, 8.78, 0.461341, 8.79, 0.483366, 8.8, 0.507583, 8.81, 0.53434, 8.82, 0.56406, 8.83, 0.597264, 8.84, 0.634608, 8.85, 0.676918, 8.86, 0.725258, 8.87, 0.781022, 8.88, 0.846063, 8.89, \
               0.922914, 8.9, 1.01512, 8.91, 1.12779, 8.92, 1.2686, 8.93, 1.44962, 8.94, 1.69096, 8.95, 2.02879, 8.96, 2.53548, 8.97, 3.37992, 8.98, 5.06869, 8.99, 10.1348, 9.,
               np.nan, 9.01, -10.1292, 9.02, -5.06306, 9.03, -3.37429, 9.04, -2.52986, 9.05, -2.02316, 9.06, -1.68533, 9.07, -1.444, \
               9.08, -1.26298, 9.09, -1.12217, 9.1, -1.0095, 9.11, -0.917303, 9.12, -0.840456, 9.13, -0.775418, 9.14, -0.719659, 9.15, -0.671322, 9.16, -0.629017, 9.17, -0.591679, 9.18, -0.558479, 9.19, -0.528766, 9.2, -0.502015, 9.21, -0.477803, \
               9.22, -0.455785, 9.23, -0.435674, 9.24, -0.417231, 9.25, -0.400257, 9.26, -0.384583, 9.27, -0.370063, 9.28, -0.356574, 9.29, -0.344009, 9.3, -0.332277, 9.31, -0.321296, 9.32, -0.310996, 9.33, -0.301315, 9.34, -0.292198, 9.35, -0.283598, \
               9.36, -0.275471, 9.37, -0.267779, 9.38, -0.260487, 9.39, -0.253564, 9.4, -0.246984, 9.41, -0.240721, 9.42, -0.234752, 9.43, -0.229056, 9.44, -0.223616, 9.45, -0.218414, 9.46, -0.213434, 9.47, -0.208663, 9.48, -0.204087, 9.49, -0.199695, \
               9.5, -0.195475, 9.51, -0.191417, 9.52, -0.187512, 9.53, -0.183752, 9.54, -0.180127, 9.55, -0.176632, 9.56, -0.173258, 9.57, -0.17, 9.58, -0.166852, 9.59, -0.163807, 9.6, -0.160861, 9.61, -0.158009, 9.62, -0.155247, 9.63, -0.152569, \
               9.64, -0.149973, 9.65, -0.147454, 9.66, -0.145009, 9.67, -0.142635, 9.68, -0.140328, 9.69, -0.138085, 9.7, -0.135904, 9.71, -0.133783, 9.72, -0.131718, 9.73, -0.129708, 9.74, -0.127749, 9.75, -0.125841, 9.76, -0.123981, 9.77, -0.122167, \
               9.78, -0.120397, 9.79, -0.118671, 9.8, -0.116985, 9.81, -0.115339, 9.82, -0.113731, 9.83, -0.112161, 9.84, -0.110625, 9.85, -0.109124, 9.86, -0.107656, 9.87, -0.10622, 9.88, -0.104814, 9.89, -0.103438, 9.9, -0.102092, 9.91, -0.100773, \
               9.92, -0.0994805, 9.93, -0.0982145, 9.94, -0.0969738, 9.95, -0.0957575, 9.96, -0.0945648, 9.97, -0.0933951, 9.98, -0.0922476, 9.99, -0.0911217, 10., -0.0900167])

#def s1(x):
#    return -np.pi/np.tan(np.pi*np.sqrt(x))/np.sqrt(x)/2/np.pi/np.pi

# these are the functions for the corrections

def func10(x):
    return 0.02039828016965850050171067491640151684 + \
        x*0.00028079187231522972262725627863494102 + \
        x*x*7.1106443697520894752690462742542018107316119403866612e-6

def func12(x):
    return 0.01696461783511260935833475977429408018 + \
        x*0.0001606449625763835134027547670140232501054152255204487937 + \
        x*x*2.782534192503503231581627e-6

def func14(x):
    return .01452348954441002699644990876158805714 + \
        x*0.0001004552114043984060805705987202112767100388726600526728 + \
        x*x*1.266093966360560056694551e-6

N = [10, 12, 14]
x_lim=[-3.0,10]
free_x=[0,1,4,9]

correction = {
    10: func10,
    12: func12,
    14: func14,
}

color = {
    10: 'red',
    12: 'green',
    14: 'blue',
}

marker = {
    10: 's',
    12: 'd',
    14: 'h',
}

aL_0p1_disp = {
    10: aL_0p1_disp10,
    12: aL_0p1_disp12,
    14: aL_0p1_disp14,
}

aL_0p1_spher = {
    10: aL_0p1_spher10,
    12: aL_0p1_spher12,
    14: aL_0p1_spher14,
}

aL_0_disp = {
    10: aL_0_disp10,
    12: aL_0_disp12,
    14: aL_0_disp14,
}

aL_0_spher = {
    10: aL_0_spher10,
    12: aL_0_spher12,
    14: aL_0_spher14,
}


setup()
fig, axs = plt.subplots(2,1,tight_layout=True)

# Plot of the zeta functions
axs[1].set_xlim(x_lim)
axs[1].set_ylim([-2,2])
axs[1].set_xlabel(r'$x$')
axs[1].set_ylabel(r'$\frac{1}{2\pi^2}S_1$')
axs[1].set_xticks(free_x)
axs[1].set_yticks([-1,0,1])
axs[1].grid(axis='both')

# axs[1].plot(s2d[0::2],  s2d[1::2],  '--',   color=color[4], alpha=1.0, label=r'$\boxplus\ N=4, n_s=\infty$')
axs[1].plot(s1[0::2],   s1[1::2],   '--',   color='grey',   alpha=0.5, label=r'$\bigcirc$')
axs[1].legend(frameon=False)

# Spherical zeta
axs[0].plot(s1[0::2],s1[1::2],'--',color='grey',markersize=3,alpha=0.5)

# Analytic lines
x = np.arange(min(x_lim), max(x_lim), 0.1)
for exact in [0.0,+0.1]:
    # Exact result, no momentum dependence, found with dispersion zeta function.
    axs[0].plot(x, exact+0*x,color='black',linewidth=0.5)

    # Whoops!  You used the spherical zeta, you need the correction.
    for n in N:
        axs[0].plot(x, exact+correction[n](x), '-', color=color[n], linewidth='0.5')

# Data points
for n in N:
    # WARNING: the data variables are all named for the opposite case!
    # non-unitary simulations
    axs[0].plot(aL_0p1_disp[n][0::2],       aL_0p1_disp[n][1::2],   marker=marker[n],    color='black', markersize=4, linestyle="None")
    axs[0].plot(aL_0p1_spher[n][0::2],      aL_0p1_spher[n][1::2],  marker=marker[n],    color=color[n],markersize=4, linestyle="None")
    # unitary simulations
    axs[0].plot(aL_0_disp[n][0::2],     aL_0_disp[n][1::2], marker=marker[n],    color='black', markersize=4, linestyle="None", markerfacecolor="None")
    axs[0].plot(aL_0_spher[n][0::2],    aL_0_spher[n][1::2],marker=marker[n],    color=color[n],markersize=4, linestyle="None", markerfacecolor="None")


axs[0].set_xlim(x_lim)
axs[0].set_ylim([-0.05,.15])
axs[0].set_ylabel(r'$\left(pL\right)^{-1}\cot\left(\delta_1\right)$')
axs[0].set_xticks(free_x)
axs[0].grid(axis='x')

finalize()
fig.savefig("1d.pdf", bbox_inches='tight')
